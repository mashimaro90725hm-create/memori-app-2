<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Memori - è¨€å¶è€ƒå¤å­¦</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Serif+JP:wght@400;700&family=Noto+Serif+SC:wght@400;700&family=Zen+Old+Mincho:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        /* ç§»æ¤æ‚¨æœ€æ ¸å¿ƒçš„â€œä¸­å›½è‰²â€ä¸»é¢˜å˜é‡ */
        :root {
            --color-bg-main: #E2E1E4; 
            --color-text-main: #2D241E; 
            --color-accent: #8e2626; 
        }
        body { margin: 0; font-family: 'Zen Old Mincho', 'Noto Serif SC', serif; background-color: var(--color-bg-main); }
        
        /* å°é¢é¡µæ ·å¼ */
        .cover-stage {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: url('./cover-bg.jpg') no-repeat center center;
            background-size: cover; display: flex; justify-content: center; align-items: center; z-index: 1000;
        }
        .cover-content { text-align: right; color: white; text-shadow: 0 2px 10px rgba(0,0,0,0.5); padding-right: 50px; }
        .cover-cat { position: absolute; left: 50px; bottom: 0; height: 80vh; transform: scaleX(-1); }

        /* ä¸»åº”ç”¨ç•Œé¢ */
        .app-container { display: flex; width: 100vw; height: 100vh; }
        .sidebar { width: 280px; background: rgba(255,253,248,0.7); backdrop-filter: blur(10px); padding: 20px; border-right: 1px solid rgba(0,0,0,0.1); }
        .main-stage { flex: 1; padding: 40px; display: flex; flex-direction: column; align-items: center; }
        
        /* æœç´¢æ¡†ä¸å¡ç‰‡ */
        .search-bar { width: 100%; max-width: 600px; display: flex; gap: 10px; margin-bottom: 40px; }
        input { flex: 1; padding: 15px 25px; border-radius: 30px; border: 1px solid #ddd; outline: none; font-size: 1.1rem; }
        
        .card {
            width: 400px; height: 550px; background: white; border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; transition: 0.5s;
        }
        .card-img { width: 100%; height: 50%; object-fit: cover; background: #eee; }
        .card-info { padding: 25px; text-align: center; }
        .main-word { font-size: 2.5rem; color: var(--color-accent); margin: 0; }
        
        /* è€ƒå¤çŒ«/ç‹—å›¾æ ‡ */
        .cat-mascot { position: fixed; bottom: 20px; right: 20px; width: 120px; cursor: pointer; transition: 0.3s; }
        .cat-mascot:hover { transform: scale(1.1); }
    </style>
</head>
<body>
    <div id="app">
        <div v-if="showCover" class="cover-stage">
            <img src="./cover-cat.png" class="cover-cat" alt="Cat">
            <div class="cover-content">
                <h1 style="font-size: 5rem; margin:0;">Memori</h1>
                <p style="font-size: 1.5rem; letter-spacing: 0.3em;">è¨€è‘‰ã®è€ƒå¤å­¦</p>
                <button @click="showCover = false" style="margin-top:40px; padding: 15px 40px; border-radius: 5px; border:none; background:#8e2626; color:white; cursor:pointer; font-weight:bold;">æ¢ç´¢ã‚’å§‹ã‚ã‚‹</button>
            </div>
        </div>

        <div v-else class="app-container">
            <aside class="sidebar">
                <h2 style="color:#8e2626;">{{ currentLang === 'jp' ? 'ğŸ‡¯ğŸ‡µ æ—¥è¯­' : 'ğŸ‡¨ğŸ‡³ æ±‰è¯­' }}</h2>
                <div style="margin-top:20px;">å·²æ”¶è—: {{ history.length }} è¯</div>
                <div style="margin-top:auto;">
                    <img src="https://img.icons8.com/color/96/shiba-inu.png" style="width:100px;">
                </div>
            </aside>

            <main class="main-stage">
                <div class="search-bar">
                    <input v-model="wordInput" @keyup.enter="generateCard" placeholder="è¾“å…¥æƒ³è¦è€ƒå¤çš„è¯æ±‡...">
                    <button @click="generateCard" style="background:none; border:none; font-size:1.5rem; cursor:pointer; color:#8e2626;"><i class="fa-solid fa-magnifying-glass"></i></button>
                </div>

                <div v-if="card.word" class="card">
                    <img :src="card.imageUrl || './cover-bg.jpg'" class="card-img">
                    <div class="card-info">
                        <h2 class="main-word">{{ card.word }}</h2>
                        <p style="color:#888;">[{{ card.reading }}]</p>
                        <div style="text-align:left; margin-top:20px; background:#f9f9f9; padding:15px; border-radius:10px;">
                            <strong>è€ƒå¤è¯æºï¼š</strong><br>{{ card.etymology }}
                        </div>
                    </div>
                </div>
            </main>

            <img src="./my-cat.png" class="cat-mascot" @click="pokeMascot">
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted } = Vue;

        createApp({
            setup() {
                const showCover = ref(true);
                const currentLang = ref('jp');
                const wordInput = ref('');
                const history = ref([]);
                const card = ref({});

                // æ ¸å¿ƒï¼šç”Ÿæˆå¡ç‰‡å¹¶å¯¹æ¥æ‚¨çš„äº‘ç«¯åç«¯
                async function generateCard() {
                    if (!wordInput.value) return;
                    try {
                        const response = await fetch(`/api/openai?word=${encodeURIComponent(wordInput.value)}`);
                        const data = await response.json();
                        // è‡ªåŠ¨ç”Ÿæˆç¬¦åˆè€ƒå¤æ°›å›´çš„é…å›¾
                        const prompt = `ancient manuscript style of ${wordInput.value}`;
                        card.value = {
                            ...data,
                            imageUrl: `https://pollinations.ai/p/${encodeURIComponent(prompt)}?width=800&height=1000&nologo=true`
                        };
                        history.value.push(data);
                    } catch (e) {
                        alert('æŒ–æ˜å¤±è´¥');
                    }
                }

                return { showCover, currentLang, wordInput, history, card, generateCard };
            }
        }).mount('#app');
    </script>
</body>
</html>
